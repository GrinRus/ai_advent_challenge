server:
  port: ${CODING_MCP_HTTP_PORT:${SERVER_PORT:8080}}

spring:
  ai:
    mcp:
      server:
        enabled: true
        stdio: false
        protocol: STREAMABLE
        name: coding-mcp
        version: 0.1.0
        type: SYNC
        annotation-scanner:
          enabled: false
        instructions: |
          Coding MCP предоставляет инструменты assisted coding поверх локального workspace:
          • coding.generate_patch — подготовка diff и сохранение патча в реестре.
          • coding.review_patch — эвристическое ревью (риски, тесты, миграции).
          • coding.apply_patch_preview — ручной dry-run (git apply, Docker runner).
          • coding.list_patches — получение списка активных патчей.
          • coding.discard_patch — удаление патча из реестра.
        capabilities:
          tool: true
          resource: false
          prompt: false
          completion: false
      streamable-http:
        mcp-endpoint: /mcp
        keep-alive-interval: 30s

coding:
  patch-ttl: ${CODING_PATCH_TTL:PT24H}
  max-diff-bytes: ${CODING_MAX_DIFF_BYTES:262144}
  max-context-bytes: ${CODING_MAX_CONTEXT_BYTES:262144}
  claude:
    enabled: ${CODING_CLAUDE_ENABLED:true}
    base-url: ${CODING_CLAUDE_BASE_URL:https://api.z.ai/api/anthropic}
    model: ${CODING_CLAUDE_MODEL:GLM-4.6}
    api-key: ${ZHIPU_API_KEY:}
    max-retries: ${CODING_CLAUDE_MAX_RETRIES:1}
    cli-bin: ${CLAUDE_CODE_BIN:claude}
    cli-timeout: ${CLAUDE_CODE_TIMEOUT:PT2M}
    api-timeout: ${CLAUDE_CODE_API_TIMEOUT:PT50M}
    default-opus-model: ${CLAUDE_CODE_DEFAULT_OPUS_MODEL:GLM-4.6}
    default-sonnet-model: ${CLAUDE_CODE_DEFAULT_SONNET_MODEL:GLM-4.6}
    default-haiku-model: ${CLAUDE_CODE_DEFAULT_HAIKU_MODEL:GLM-4.5-Air}
